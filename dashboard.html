<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>DeltaV â€” ğŸ“Š Dashboard</title><link rel="stylesheet" href="theme.css"><style></style></head><body><script>if(sessionStorage.getItem("dv_admin")!=="1"){location.href="login.html";}</script><div class="sidebar"><div class="sb-logo">DeltaV <span>Auto</span><small>Admin Panel</small></div><nav><div class="sb-sec">Core</div><a href="dashboard.html" class="active"><span class="ni">ğŸ“Š</span>Dashboard</a><a href="admin.html" class=""><span class="ni">ğŸ“…</span>Bookings</a><a href="schedule.html" class=""><span class="ni">ğŸ—“ï¸</span>Schedule</a><a href="customers.html" class=""><span class="ni">ğŸ‘¥</span>Customers</a><a href="invoices.html" class=""><span class="ni">ğŸ’°</span>Invoices</a><div class="sb-sec">Stock & Money</div><a href="inventory.html" class=""><span class="ni">ğŸ“¦</span>Inventory</a><a href="payments.html" class=""><span class="ni">ğŸ’³</span>Payments</a><a href="finance.html" class=""><span class="ni">ğŸ“ˆ</span>Finance</a><a href="workers.html" class=""><span class="ni">ğŸ‘·</span>Workers</a><div class="sb-sec">Operations</div><a href="jobs.html" class=""><span class="ni">ğŸ”©</span>Job Cards</a><a href="quotes.html" class=""><span class="ni">ğŸ“‹</span>Quotes</a><a href="suppliers.html" class=""><span class="ni">ğŸ­</span>Suppliers</a><a href="expenses.html" class=""><span class="ni">ğŸ§¾</span>Expenses</a><a href="reports.html" class=""><span class="ni">ğŸ“‰</span>Reports</a><div class="sb-sec">Communication</div><a href="messages.html" class=""><span class="ni">ğŸ’¬</span>Messages</a><a href="notes.html" class=""><span class="ni">ğŸ“</span>Notes</a><a href="reminders.html" class=""><span class="ni">ğŸ””</span>Reminders</a><a href="vehicles.html" class=""><span class="ni">ğŸš—</span>Vehicle DB</a><div class="sb-sec">Extra</div><a href="audit.html" class=""><span class="ni">ğŸ”</span>Audit Log</a><a href="tasks.html" class=""><span class="ni">âœ…</span>Tasks</a><a href="timesheets.html" class=""><span class="ni">â±ï¸</span>Timesheets</a><a href="warranties.html" class=""><span class="ni">ğŸ›¡ï¸</span>Warranties</a><a href="promotions.html" class=""><span class="ni">ğŸ</span>Promotions</a><a href="feedback.html" class=""><span class="ni">â­</span>Feedback</a><a href="returns.html" class=""><span class="ni">â†©ï¸</span>Returns</a><a href="waiting.html" class=""><span class="ni">â³</span>Waiting List</a><a href="checklist.html" class=""><span class="ni">â˜‘ï¸</span>Checklists</a><a href="gallery-admin.html" class=""><span class="ni">ğŸ“¸</span>Gallery Mgr</a><a href="targets.html" class=""><span class="ni">ğŸ¯</span>Targets</a><a href="settings.html" class=""><span class="ni">âš™ï¸</span>Settings</a></nav><div class="sb-foot"><a href="index.html" class="btn-sb-link">ğŸŒ Website</a><button class="btn-sb-out" onclick="if(confirm('Log out?')){sessionStorage.removeItem('dv_admin');location.href='login.html';}">ğŸšª Log Out</button></div></div><div class="main"><div class="topbar"><h1>ğŸ“Š Dashboard</h1><div class="tr"><button class="btn btn-ghost" onclick="loadDash()">ğŸ”„ Refresh</button><a href="reports.html" class="btn btn-info">ğŸ“‰ Reports</a></div></div><div class="body"><div class="stat-grid">
  <div class="card"><div class="card-title">ğŸ“… Total Bookings</div><div class="card-val" id="sTB">â€”</div><div class="card-sub">All time</div></div>
  <div class="card"><div class="card-title">â³ Pending</div><div class="card-val" id="sPen" style="color:var(--wa)">â€”</div><div class="card-sub">Awaiting confirmation</div></div>
  <div class="card"><div class="card-title">âœ… Today's Jobs</div><div class="card-val" id="sTod" style="color:var(--ok)">â€”</div><div class="card-sub">Confirmed for today</div></div>
  <div class="card"><div class="card-title">ğŸ’° Month Revenue</div><div class="card-val" id="sRev">â€”</div><div class="card-sub">Paid invoices this month</div></div>
  <div class="card"><div class="card-title">ğŸ“¦ In Stock</div><div class="card-val" id="sStk">â€”</div><div class="card-sub">Active inventory items</div></div>
  <div class="card"><div class="card-title">ğŸ§¾ Unpaid</div><div class="card-val" id="sUnp" style="color:var(--er)">â€”</div><div class="card-sub">Outstanding invoices</div></div>
</div>
<div style="display:grid;grid-template-columns:1fr 1fr;gap:18px;margin-bottom:18px">
  <div class="card-flat"><div class="sh"><h2>ğŸ“… Recent Bookings</h2><a href="admin.html" class="btn btn-dark btn-sm">View All</a></div><div id="rBk"><p style="color:#aaa;font-size:.84rem">Loading...</p></div></div>
  <div class="card-flat"><div class="sh"><h2>ğŸ’° Recent Invoices</h2><a href="invoices.html" class="btn btn-dark btn-sm">View All</a></div><div id="rInv"><p style="color:#aaa;font-size:.84rem">Loading...</p></div></div>
</div>
<div class="card-flat"><div class="sh"><h2>âš¡ Quick Actions</h2></div>
<div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:9px">
  <a href="admin.html" class="btn btn-dark btn-fw">ğŸ“… Bookings</a>
  <a href="invoices.html" class="btn btn-primary btn-fw">ğŸ’° New Invoice</a>
  <a href="inventory.html" class="btn btn-success btn-fw">ğŸ“¦ Inventory</a>
  <a href="customers.html" class="btn btn-info btn-fw">ğŸ‘¥ Customers</a>
  <a href="schedule.html" class="btn btn-purple btn-fw">ğŸ—“ï¸ Schedule</a>
  <a href="jobs.html" class="btn btn-fw" style="background:linear-gradient(135deg,#6c757d,#868e96);color:#fff">ğŸ”© Job Cards</a>
  <a href="quotes.html" class="btn btn-warning btn-fw">ğŸ“‹ Quotes</a>
  <a href="finance.html" class="btn btn-fw" style="background:linear-gradient(135deg,#20c997,#0ca678);color:#fff">ğŸ“ˆ Finance</a>
  <a href="reminders.html" class="btn btn-fw" style="background:linear-gradient(135deg,#e83e8c,#c82371);color:#fff">ğŸ”” Reminders</a>
  <a href="reports.html" class="btn btn-fw" style="background:linear-gradient(135deg,#6610f2,#520dc2);color:#fff">ğŸ“‰ Reports</a>
  <a href="tasks.html" class="btn btn-fw" style="background:linear-gradient(135deg,#17a2b8,#0e6b7a);color:#fff">âœ… Tasks</a>
  <a href="waiting.html" class="btn btn-fw" style="background:linear-gradient(135deg,#fd7e14,#c96000);color:#fff">â³ Waiting</a>
</div></div></div></div><div class="modal" id="mDel"><div class="mbox" style="max-width:370px"><h3>ğŸ—‘ï¸ Confirm Delete</h3><p id="mDelMsg" style="color:#555;margin-bottom:4px">This cannot be undone.</p><div class="mfoot"><button class="btn btn-ghost" onclick="closeM('mDel')">Cancel</button><button class="btn btn-danger" id="mDelBtn">Yes, Delete</button></div></div></div><script src="shared.js"></script><script>
async function loadDash(){
  try{
    const[bk,inv,invt]=await Promise.all([dbGet("bookings"),dbGet("invoices"),dbGet("inventory")]);
    const td=today(),mn=td.slice(0,7);
    document.getElementById("sTB").textContent=bk.length;
    document.getElementById("sPen").textContent=bk.filter(b=>b.status==="pending").length;
    document.getElementById("sTod").textContent=bk.filter(b=>b.confirmed_date===td).length;
    const rev=inv.filter(i=>i.payment_status==="paid"&&(i.invoice_date||"").startsWith(mn)).reduce((s,i)=>s+(i.total_amount||0),0);
    document.getElementById("sRev").textContent=fmtGBP(rev);
    document.getElementById("sStk").textContent=invt.filter(i=>i.status==="active").length;
    document.getElementById("sUnp").textContent=inv.filter(i=>i.payment_status==="unpaid").length;
    const rb=document.getElementById("rBk");rb.innerHTML="";
    bk.slice(-5).reverse().forEach(b=>{rb.innerHTML+=`<div style="display:flex;justify-content:space-between;padding:9px 0;border-bottom:1px solid #f0f2f5;font-size:.84rem"><div><strong>${b.name}</strong><br><span style="color:#999">${b.reg} Â· ${b.date||""}</span></div><span class="badge ${b.status==="confirmed"?"b-ok":"b-wa"}">${b.status}</span></div>`;});
    const ri=document.getElementById("rInv");ri.innerHTML="";
    inv.slice(-5).reverse().forEach(i=>{ri.innerHTML+=`<div style="display:flex;justify-content:space-between;padding:9px 0;border-bottom:1px solid #f0f2f5;font-size:.84rem"><div><strong>${i.customer_name}</strong><br><span style="color:#999">${i.invoice_date||""}</span></div><strong style="color:var(--ac)">${fmtGBP(i.total_amount)}</strong></div>`;});
  }catch(e){console.error(e)}
}
loadDash();setInterval(loadDash,30000);
</script></body></html>