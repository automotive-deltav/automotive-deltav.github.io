<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>DeltaV â€” ğŸ›’ Parts Orders</title><link rel="stylesheet" href="theme.css"><style></style></head><body><script>if(sessionStorage.getItem("dv_admin")!=="1"){location.href="login.html";}</script><div class="sidebar"><div class="sb-logo">DeltaV <span>Auto</span><small>Admin Panel</small></div><nav><div class="sb-sec">Core</div><a href="dashboard.html" class=""><span class="ni">ğŸ“Š</span>Dashboard</a><a href="admin.html" class=""><span class="ni">ğŸ“…</span>Bookings</a><a href="schedule.html" class=""><span class="ni">ğŸ—“ï¸</span>Schedule</a><a href="customers.html" class=""><span class="ni">ğŸ‘¥</span>Customers</a><a href="invoices.html" class=""><span class="ni">ğŸ’°</span>Invoices</a><div class="sb-sec">Stock & Money</div><a href="inventory.html" class=""><span class="ni">ğŸ“¦</span>Inventory</a><a href="payments.html" class=""><span class="ni">ğŸ’³</span>Payments</a><a href="finance.html" class=""><span class="ni">ğŸ“ˆ</span>Finance</a><a href="workers.html" class=""><span class="ni">ğŸ‘·</span>Workers</a><div class="sb-sec">Operations</div><a href="jobs.html" class=""><span class="ni">ğŸ”©</span>Job Cards</a><a href="quotes.html" class=""><span class="ni">ğŸ“‹</span>Quotes</a><a href="suppliers.html" class=""><span class="ni">ğŸ­</span>Suppliers</a><a href="expenses.html" class=""><span class="ni">ğŸ§¾</span>Expenses</a><a href="reports.html" class=""><span class="ni">ğŸ“‰</span>Reports</a><div class="sb-sec">Comms & Tools</div><a href="messages.html" class=""><span class="ni">ğŸ’¬</span>Messages</a><a href="notes.html" class=""><span class="ni">ğŸ“</span>Notes</a><a href="reminders.html" class=""><span class="ni">ğŸ””</span>Reminders</a><a href="vehicles.html" class=""><span class="ni">ğŸš—</span>Vehicle DB</a><a href="tasks.html" class=""><span class="ni">âœ…</span>Tasks</a><a href="timesheets.html" class=""><span class="ni">â±ï¸</span>Timesheets</a><div class="sb-sec">Extra</div><a href="warranties.html" class=""><span class="ni">ğŸ›¡ï¸</span>Warranties</a><a href="promotions.html" class=""><span class="ni">ğŸ</span>Promotions</a><a href="feedback.html" class=""><span class="ni">â­</span>Feedback</a><a href="returns.html" class=""><span class="ni">â†©ï¸</span>Returns</a><a href="waiting.html" class=""><span class="ni">â³</span>Waiting List</a><a href="checklist.html" class=""><span class="ni">â˜‘ï¸</span>Checklists</a><a href="targets.html" class=""><span class="ni">ğŸ¯</span>Targets</a><a href="audit.html" class=""><span class="ni">ğŸ”</span>Audit Log</a><a href="gallery_mgr.html" class=""><span class="ni">ğŸ“¸</span>Gallery Mgr</a><div class="sb-sec">Advanced</div><a href="sms.html" class=""><span class="ni">ğŸ“±</span>SMS / Email</a><a href="loyalty.html" class=""><span class="ni">ğŸ…</span>Loyalty</a><a href="parts_orders.html" class="active"><span class="ni">ğŸ›’</span>Parts Orders</a><a href="MOT.html" class=""><span class="ni">ğŸ”–</span>MOT Tracker</a><a href="service_history.html" class=""><span class="ni">ğŸ“œ</span>Svc History</a><a href="staff_rota.html" class=""><span class="ni">ğŸ“†</span>Staff Rota</a><a href="hours.html" class=""><span class="ni">â°</span>Opening Hours</a><a href="settings.html" class=""><span class="ni">âš™ï¸</span>Settings</a></nav><div class="sb-foot"><a href="index.html" class="btn-sb-link">ğŸŒ Website</a><button class="btn-sb-out" onclick="if(confirm('Log out?')){sessionStorage.removeItem('dv_admin');location.href='login.html';}">ğŸšª Log Out</button></div></div><div class="main"><div class="topbar"><h1>ğŸ›’ Parts Orders</h1><div class="tr"><button class="btn btn-primary" onclick="openNew()">+ New Parts Order</button><button class="btn btn-info" onclick="doExport()">ğŸ“¥ Export</button><button class="btn btn-ghost" onclick="loadData()">ğŸ”„ Refresh</button></div></div><div class="body">
<div style="display:flex;gap:8px;margin-bottom:14px;flex-wrap:wrap;align-items:center">
  <div class="srch-w"><input type="text" id="srch_parts_orders.html" placeholder="Search parts orders..." oninput="renderData()"></div>
  <button class="btn btn-ghost btn-sm" onclick="loadData()">ğŸ”„</button>
  <button class="btn btn-info btn-sm" onclick="doExport()">ğŸ“¥ CSV</button>
  <button class="btn btn-warning btn-sm" onclick="window.print()">ğŸ–¨ï¸ Print</button>
</div>
<div class="tbl-wrap"><table><thead><tr>
  <th>Date</th><th>Supplier</th><th>Part Name</th><th>Part Code</th><th>Quantity</th><th>Cost</th><th>Status</th>
  
  <th>Actions</th>
</tr></thead><tbody id="tb_parts_orders.html"></tbody></table></div>
<div class="modal" id="m_parts_orders.html"><div class="mbox">
  <h3 id="m_parts_orders.html_tit">â• New Entry</h3>
  <div class="fg"><label>Date</label><input type="date" id="f_parts_orders.html_0" placeholder=""></div><div class="fg"><label>Supplier</label><input type="text" id="f_parts_orders.html_1" placeholder="Supplier name"></div><div class="fg"><label>Part Name</label><input type="text" id="f_parts_orders.html_2" placeholder="Part description"></div><div class="fg"><label>Part Code</label><input type="text" id="f_parts_orders.html_3" placeholder="P-001"></div><div class="fg"><label>Quantity</label><input type="number" id="f_parts_orders.html_4" placeholder="1"></div><div class="fg"><label>Cost</label><input type="number" id="f_parts_orders.html_5" placeholder="0.00"></div><div class="fg"><label>Status</label><input type="text" id="f_parts_orders.html_6" placeholder="Ordered"></div>
  
  <div class="mfoot">
    <button class="btn btn-ghost" onclick="closeM('m_parts_orders.html')">Cancel</button>
    <button class="btn btn-primary" onclick="saveData()">ğŸ’¾ Save</button>
  </div>
</div></div></div></div><div class="modal" id="mDel"><div class="mbox" style="max-width:360px"><h3>ğŸ—‘ï¸ Confirm Delete</h3><p id="mDelMsg" style="color:#555">This cannot be undone.</p><div class="mfoot"><button class="btn btn-ghost" onclick="closeM('mDel')">Cancel</button><button class="btn btn-danger" id="mDelBtn">Yes, Delete</button></div></div></div><script src="shared.js"></script><script>
let data_parts_orders.html=[],edit_parts_orders.html=null;
async function loadData(){data_parts_orders.html=await dbGet("parts_orders");renderData();}
function renderData(){
  const q=document.getElementById("srch_parts_orders.html").value.toLowerCase();
  const f=data_parts_orders.html.filter(r=>Object.values(r).some(v=>String(v||"").toLowerCase().includes(q)));
  const tb=document.getElementById("tb_parts_orders.html");tb.innerHTML="";
  if(!f.length){tb.innerHTML=`<tr><td colspan="99"><div class="empty"><div class="ei">ğŸ›’</div><p>No parts orders found</p></div></td></tr>`;return;}
  f.forEach(r=>{
    tb.innerHTML+=`<tr>$<td>{{r.order_date}}</td><td>{{r.supplier}}</td><td>{{r.part_name}}</td><td>{{r.part_code}}</td><td>{{r.quantity}}</td><td>{{r.cost}}</td><td>{{r.status}}</td><td>
      <button class="btn btn-warning btn-sm" onclick="editRow('${r.id}')">âœï¸ Edit</button>
      <button class="btn btn-danger btn-sm" onclick="delRow('${r.id}')">ğŸ—‘ï¸</button>
    </td></tr>`;
  });
}
function openNew(){edit_parts_orders.html=null;document.getElementById("m_parts_orders.html_tit").textContent="â• New Parts Order";document.getElementById("f_parts_orders.html_0").value="";document.getElementById("f_parts_orders.html_1").value="";document.getElementById("f_parts_orders.html_2").value="";document.getElementById("f_parts_orders.html_3").value="";document.getElementById("f_parts_orders.html_4").value="";document.getElementById("f_parts_orders.html_5").value="";document.getElementById("f_parts_orders.html_6").value="";openM("m_parts_orders.html");}
function editRow(id){const r=data_parts_orders.html.find(x=>x.id===id);if(!r)return;edit_parts_orders.html=id;document.getElementById("m_parts_orders.html_tit").textContent="âœï¸ Edit";document.getElementById("f_parts_orders.html_0").value=r["order_date"]||"";document.getElementById("f_parts_orders.html_1").value=r["supplier"]||"";document.getElementById("f_parts_orders.html_2").value=r["part_name"]||"";document.getElementById("f_parts_orders.html_3").value=r["part_code"]||"";document.getElementById("f_parts_orders.html_4").value=r["quantity"]||"";document.getElementById("f_parts_orders.html_5").value=r["cost"]||"";document.getElementById("f_parts_orders.html_6").value=r["status"]||"";openM("m_parts_orders.html");}
async function saveData(){
  const d={};
  d["order_date"]=document.getElementById("f_parts_orders.html_0").value.trim()||null;d["supplier"]=document.getElementById("f_parts_orders.html_1").value.trim()||null;d["part_name"]=document.getElementById("f_parts_orders.html_2").value.trim()||null;d["part_code"]=document.getElementById("f_parts_orders.html_3").value.trim()||null;d["quantity"]=document.getElementById("f_parts_orders.html_4").value.trim()||null;d["cost"]=document.getElementById("f_parts_orders.html_5").value.trim()||null;d["status"]=document.getElementById("f_parts_orders.html_6").value.trim()||null
  if(!d["order_date"]){toast("Fill required field","er");return;}
  if(edit_parts_orders.html){await dbUpd("parts_orders",edit_parts_orders.html,d);toast("Updated!");}else{await dbIns("parts_orders",d);toast("Saved!");}
  closeM("m_parts_orders.html");loadData();
}
function delRow(id){confirmDel("Delete this entry?",async()=>{await dbDel("parts_orders",id);data_parts_orders.html=data_parts_orders.html.filter(x=>x.id!==id);renderData();toast("Deleted","in");});}
function doExport(){const rows=[['["Date"]', '["Supplier"]', '["Part Name"]', '["Part Code"]', '["Quantity"]', '["Cost"]', '["Status"]']];data_parts_orders.html.forEach(r=>rows.push([r["order_date"]||"",r["supplier"]||"",r["part_name"]||"",r["part_code"]||"",r["quantity"]||"",r["cost"]||"",r["status"]||""]));const csv=rows.map(r=>r.map(c=>`"${c||""}"`).join(",")).join("\n");const a=document.createElement("a");a.href="data:text/csv,"+encodeURIComponent(csv);a.download="parts_orders.csv";a.click();}

loadData();
</script></body></html>